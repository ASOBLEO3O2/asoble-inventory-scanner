<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>棚卸スキャナ</title>

  <!-- CSS -->
  <link rel="stylesheet" href="./style.css" />

  <!-- カメラ用ライブラリ（先読み） -->
  <script src="https://unpkg.com/html5-qrcode"></script>
</head>

<body>
  <header id="title">棚卸スキャナ（店舗選択）</header>

  <div class="badges">
    <div class="badge" id="storeBadge">store: HOME</div>
    <div class="badge" id="countBadge">rows: -</div>
    <div class="badge" id="progressBadge">progress: -</div>
    <div class="badge" id="remainBadge">remain: -</div>
    <div class="badge" id="ngBadge">ng: 0</div>
    <div class="badge" id="updatedBadge">updated: -</div>
  </div>

  <main>
    <!-- 店舗選択 -->
    <div id="home" class="card">
      <div class="muted small">店舗を選ぶとスキャン画面に移動します。</div>
      <div id="storeGrid" class="storeGrid"></div>
    </div>

    <!-- スキャナ -->
    <div id="scanner" style="display:none">
      <div class="card">
        <button id="btnHome" class="secondary">店舗一覧</button>
        <button id="btnClear" class="secondary">今回をクリア</button>
        <button id="btnShowRemain" class="secondary">未スキャン一覧</button>
      </div>

      <div class="card">
        <p class="muted">
          ※ バーコードスキャナ運用推奨（Enterで確定）<br />
          カメラは必要なときだけ全画面で起動します
        </p>

        <button id="btnCamera">📷 カメラでスキャン（全画面）</button>

        <div class="progressWrap">
          <div class="muted small" id="progressText">progress: -</div>
          <div class="progressBar"><div class="progressFill" id="progressFill"></div></div>
        </div>

        <input id="scanInput" placeholder="ここにフォーカス → スキャン…" autocomplete="off" />
        <div id="msg" class="muted"></div>
      </div>

      <div class="card">
        <strong>現在の一致</strong>
        <div id="current" class="stack"></div>
      </div>

      <div class="card">
        <strong>スキャン履歴（今回）</strong>
        <div id="history" class="stack"></div>
      </div>

      <div class="card" id="remainCard" style="display:none">
        <strong>未スキャン一覧（この店舗）</strong>
        <div class="muted small" style="margin-top:6px">
          残りを「管理No ／ マシン名」で表示（長い場合は一部省略）。
        </div>
        <div id="remainList" class="remainList"></div>
      </div>
    </div>
  </main>

  <!-- 棚卸完了 -->
  <div id="doneOverlay">
    <div id="doneCard">
      <div id="doneTitle">棚卸完了！🎉</div>
      <div id="doneSub">全件スキャン済みです</div>
      <button id="btnDoneClose" class="secondary">閉じる</button>
    </div>
  </div>

  <!-- カメラ全画面モーダル -->
  <div id="camModal" aria-hidden="true">
    <div id="camTop">
      <div id="camHint">シール（5×3.5cm）を枠に入れるだけでOK</div>
      <button id="camClose" class="secondary">⏹ 閉じる</button>
    </div>

    <div id="qrReader"></div>

    <div id="camFrame" aria-hidden="true">
      <div class="corner tl"></div>
      <div class="corner tr"></div>
      <div class="corner br"></div>
      <div class="corner bl"></div>
    </div>
  </div>

  <!-- JS -->
  <script src="./app.js"></script>
</body>
</html>
